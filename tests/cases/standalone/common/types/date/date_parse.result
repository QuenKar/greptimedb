SELECT '1992-01-01'::DATE::VARCHAR = '1992-01-01';

+-----------------------------------------+
| Utf8("1992-01-01") = Utf8("1992-01-01") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '1992-09-20'::DATE::VARCHAR = '1992-09-20';

+-----------------------------------------+
| Utf8("1992-09-20") = Utf8("1992-09-20") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '1992-02-29'::DATE::VARCHAR = '1992-02-29';

+-----------------------------------------+
| Utf8("1992-02-29") = Utf8("1992-02-29") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '3600-02-29'::DATE::VARCHAR = '3600-02-29';

+-----------------------------------------+
| Utf8("3600-02-29") = Utf8("3600-02-29") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '0030-01-01'::DATE::VARCHAR = '0030-01-01';

+-----------------------------------------+
| Utf8("0030-01-01") = Utf8("0030-01-01") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '30000-01-01'::DATE::VARCHAR = '30000-01-01';

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '30000-01-01' to value of Date32 type

SELECT '1969-01-01'::DATE::VARCHAR = '1969-01-01';

+-----------------------------------------+
| Utf8("1969-01-01") = Utf8("1969-01-01") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '1970-01-01'::DATE::VARCHAR = '1970-01-01';

+-----------------------------------------+
| Utf8("1970-01-01") = Utf8("1970-01-01") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '2369-01-01'::DATE::VARCHAR = '2369-01-01';

+-----------------------------------------+
| Utf8("2369-01-01") = Utf8("2369-01-01") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '2370-01-01'::DATE::VARCHAR = '2370-01-01';

+-----------------------------------------+
| Utf8("2370-01-01") = Utf8("2370-01-01") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '2371-01-01'::DATE::VARCHAR = '2371-01-01';

+-----------------------------------------+
| Utf8("2371-01-01") = Utf8("2371-01-01") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '-1000-01-01'::DATE::VARCHAR = '1001-01-01 (BC)';

+-----------------------------------------------+
| Utf8("-1000-01-01") = Utf8("1001-01-01 (BC)") |
+-----------------------------------------------+
| false                                         |
+-----------------------------------------------+

SELECT '1992/09/20'::DATE::VARCHAR = '1992-09-20';

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992/09/20' to value of Date32 type

SELECT '1992 09 20'::DATE::VARCHAR = '1992-09-20';

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992 09 20' to value of Date32 type

SELECT '1992\09\20'::DATE::VARCHAR = '1992-09-20';

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992\09\20' to value of Date32 type

-- verify bounds of each month
-- January - 31 days
-- February - 28 days in non-leap year, 29 days in leap year
-- March - 31 days
-- April - 30 days
-- May - 31 days
-- June - 30 days
-- July - 31 days
-- August - 31 days
-- September - 30 days
-- October - 31 days
-- November - 30 days
-- December - 31 day
-- non leap year
SELECT '1993-01-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-01-31") |
+--------------------+
| 1993-01-31         |
+--------------------+

SELECT '1993-01-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-01-32' to value of Date32 type

SELECT '1993-02-28'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-02-28") |
+--------------------+
| 1993-02-28         |
+--------------------+

SELECT '1993-02-29'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-02-29' to value of Date32 type

SELECT '1993-03-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-03-31") |
+--------------------+
| 1993-03-31         |
+--------------------+

SELECT '1993-03-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-03-32' to value of Date32 type

SELECT '1993-04-30'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-04-30") |
+--------------------+
| 1993-04-30         |
+--------------------+

SELECT '1993-04-31'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-04-31' to value of Date32 type

SELECT '1993-05-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-05-31") |
+--------------------+
| 1993-05-31         |
+--------------------+

SELECT '1993-05-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-05-32' to value of Date32 type

SELECT '1993-06-30'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-06-30") |
+--------------------+
| 1993-06-30         |
+--------------------+

SELECT '1993-06-31'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-06-31' to value of Date32 type

SELECT '1993-07-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-07-31") |
+--------------------+
| 1993-07-31         |
+--------------------+

SELECT '1993-07-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-07-32' to value of Date32 type

SELECT '1993-08-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-08-31") |
+--------------------+
| 1993-08-31         |
+--------------------+

SELECT '1993-08-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-08-32' to value of Date32 type

SELECT '1993-09-30'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-09-30") |
+--------------------+
| 1993-09-30         |
+--------------------+

SELECT '1993-09-31'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-09-31' to value of Date32 type

SELECT '1993-10-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-10-31") |
+--------------------+
| 1993-10-31         |
+--------------------+

SELECT '1993-10-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-10-32' to value of Date32 type

SELECT '1993-11-30'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-11-30") |
+--------------------+
| 1993-11-30         |
+--------------------+

SELECT '1993-11-31'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-11-31' to value of Date32 type

SELECT '1993-12-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1993-12-31") |
+--------------------+
| 1993-12-31         |
+--------------------+

SELECT '1993-12-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1993-12-32' to value of Date32 type

-- leap year
SELECT '1992-01-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-01-31") |
+--------------------+
| 1992-01-31         |
+--------------------+

SELECT '1992-01-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-01-32' to value of Date32 type

SELECT '1992-02-29'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-02-29") |
+--------------------+
| 1992-02-29         |
+--------------------+

SELECT '1992-02-30'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-02-30' to value of Date32 type

SELECT '1992-03-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-03-31") |
+--------------------+
| 1992-03-31         |
+--------------------+

SELECT '1992-03-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-03-32' to value of Date32 type

SELECT '1992-04-30'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-04-30") |
+--------------------+
| 1992-04-30         |
+--------------------+

SELECT '1992-04-31'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-04-31' to value of Date32 type

SELECT '1992-05-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-05-31") |
+--------------------+
| 1992-05-31         |
+--------------------+

SELECT '1992-05-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-05-32' to value of Date32 type

SELECT '1992-06-30'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-06-30") |
+--------------------+
| 1992-06-30         |
+--------------------+

SELECT '1992-06-31'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-06-31' to value of Date32 type

SELECT '1992-07-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-07-31") |
+--------------------+
| 1992-07-31         |
+--------------------+

SELECT '1992-07-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-07-32' to value of Date32 type

SELECT '1992-08-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-08-31") |
+--------------------+
| 1992-08-31         |
+--------------------+

SELECT '1992-08-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-08-32' to value of Date32 type

SELECT '1992-09-30'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-09-30") |
+--------------------+
| 1992-09-30         |
+--------------------+

SELECT '1992-09-31'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-09-31' to value of Date32 type

SELECT '1992-10-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-10-31") |
+--------------------+
| 1992-10-31         |
+--------------------+

SELECT '1992-10-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-10-32' to value of Date32 type

SELECT '1992-11-30'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-11-30") |
+--------------------+
| 1992-11-30         |
+--------------------+

SELECT '1992-11-31'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-11-31' to value of Date32 type

SELECT '1992-12-31'::DATE::VARCHAR;

+--------------------+
| Utf8("1992-12-31") |
+--------------------+
| 1992-12-31         |
+--------------------+

SELECT '1992-12-32'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-12-32' to value of Date32 type

-- 1900 is not a leap year
SELECT '1900-02-29'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1900-02-29' to value of Date32 type

-- 2000 is a leap year
SELECT '2000-02-29'::DATE::VARCHAR = '2000-02-29';

+-----------------------------------------+
| Utf8("2000-02-29") = Utf8("2000-02-29") |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+

SELECT '0-01-01'::DATE::VARCHAR;

+-----------------+
| Utf8("0-01-01") |
+-----------------+
| 0000-01-01      |
+-----------------+

-- year 1 and -1 are fine
SELECT '1-01-01'::DATE::VARCHAR;

+-----------------+
| Utf8("1-01-01") |
+-----------------+
| 0001-01-01      |
+-----------------+

SELECT '-1-01-01'::DATE::VARCHAR;

+------------------+
| Utf8("-1-01-01") |
+------------------+
| -0001-01-01      |
+------------------+

-- various invalid formats
SELECT '100000'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '100000' to value of Date32 type

SELECT '1992-10/10'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-10/10' to value of Date32 type

SELECT '1992a10a10'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992a10a10' to value of Date32 type

SELECT '1992/10-10'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992/10-10' to value of Date32 type

SELECT 'hello'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string 'hello' to value of Date32 type

SELECT 'aa-10-10'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string 'aa-10-10' to value of Date32 type

SELECT '1992-aa-10'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-aa-10' to value of Date32 type

SELECT '1992-10-aa'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-10-aa' to value of Date32 type

SELECT ''::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '' to value of Date32 type

SELECT '-'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '-' to value of Date32 type

SELECT '-/10/10'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '-/10/10' to value of Date32 type

SELECT '-a'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '-a' to value of Date32 type

SELECT '1992-'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-' to value of Date32 type

SELECT '1992-10'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-10' to value of Date32 type

SELECT '1992-10-'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-10-' to value of Date32 type

-- dates out of range
SELECT '10000000000-01-01'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '10000000000-01-01' to value of Date32 type

SELECT '-10000000000-01-01'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '-10000000000-01-01' to value of Date32 type

SELECT '1992-30-30'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-30-30' to value of Date32 type

SELECT '1992-00-50'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-00-50' to value of Date32 type

SELECT '1992-01-00'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-01-00' to value of Date32 type

SELECT '1992-10-50'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-10-50' to value of Date32 type

SELECT '1992-10-100'::DATE::VARCHAR;

Error: 3001(EngineExecuteQuery), Cast error: Cannot cast string '1992-10-100' to value of Date32 type

